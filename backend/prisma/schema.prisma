generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

generator prismabox {
  provider                    = "prismabox"
  typeboxImportDependencyName = "elysia"
  typeboxImportVariableName   = "t"
  inputModel                  = true
  output                      = "../generated/prismabox"
}

model User {
  id             String  @id @default(uuid())
  username       String  @unique
  hashedPassword String
  images         Image[]
}

model Image {
  id       String @id @default(cuid())
  url      String
  filename String
  mimeType String
  size     Int
  width    Int?
  height   Int?
  userId   String
  user     User   @relation(references: [id], fields: [userId])

  // Transformed images
  parentId        String?
  parent          Image?  @relation("ImageTransform", fields: [parentId], references: [id])
  transformations Json?
  isOriginal      Boolean @default(true)

  uploadedAt DateTime @default(now())
  images     Image[]  @relation("ImageTransform")
}
